<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏á SMS - ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏™‡∏∏‡∏£‡∏≤‡∏©‡∏è‡∏£‡πå‡∏ò‡∏≤‡∏ô‡∏µ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Sarabun', sans-serif; }
        .bg-pastel-green { background-color: #e8f5e8; }
        .bg-green-pastel { background-color: #c8e6c9; }
        .text-green-dark { color: #2e7d32; }
        .border-green-pastel { border-color: #a5d6a7; }
        .hover-green:hover { background-color: #d1f0d1; }
        .swal2-popup { font-family: 'Sarabun', sans-serif; }
    </style>
</head>
<body class="bg-pastel-green min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-lg border-b-4 border-green-pastel">
        <div class="container mx-auto px-6 py-4">
            <h1 class="text-3xl font-bold text-green-dark text-center">
                üè• ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏á SMS
            </h1>
            <p class="text-center text-gray-600 mt-2">‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏™‡∏∏‡∏£‡∏≤‡∏©‡∏è‡∏£‡πå‡∏ò‡∏≤‡∏ô‡∏µ (v.GoogleSheets)</p>
        </div>
    </header>

    <div class="container mx-auto px-6 py-8 max-w-6xl">
        <!-- SMS Data Entry Form -->
        <div class="bg-white rounded-xl shadow-lg p-6 border-2 border-green-pastel">
            <h2 class="text-2xl font-semibold text-green-dark mb-6 flex items-center">
                üì± ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏á SMS
            </h2>
            
            <form id="smsForm" class="space-y-6">
                <!-- Date Input -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á <span class="text-red-500">*</span>
                    </label>
                    <input type="date" id="sendDate" required
                           class="w-full px-4 py-3 border-2 border-green-pastel rounded-lg focus:ring-2 focus:ring-green-400 focus:border-transparent">
                </div>

                <!-- Phone Number -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        üìû ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ (10 ‡∏´‡∏•‡∏±‡∏Å) <span class="text-red-500">*</span>
                    </label>
                    <input type="tel" id="phoneNumber" required maxlength="10" pattern="[0-9]{10}"
                           placeholder="0812345678"
                           class="w-full px-4 py-3 border-2 border-green-pastel rounded-lg focus:ring-2 focus:ring-green-400 focus:border-transparent">
                </div>

                <!-- Pet Name -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        üêï ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏ß‡πå <span class="text-red-500">*</span>
                    </label>
                    <input type="text" id="petName" required
                           placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á"
                           class="w-full px-4 py-3 border-2 border-green-pastel rounded-lg focus:ring-2 focus:ring-green-400 focus:border-transparent">
                </div>

                <!-- Appointment Type -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-4">
                        üíâ ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ô‡∏±‡∏î <span class="text-red-500">*</span>
                    </label>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3 max-h-64 overflow-y-auto border-2 border-green-pastel rounded-lg p-4">
                        <label class="flex items-start space-x-3 p-3 rounded-lg hover-green cursor-pointer"><input type="radio" name="appointmentType" value="‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏ô‡∏±‡∏Ç‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÇ‡∏£‡∏Ñ‡∏û‡∏¥‡∏©‡∏™‡∏∏‡∏ô‡∏±‡∏Ç‡∏ö‡πâ‡∏≤ ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ : ‡∏á‡∏î‡∏≠‡∏≤‡∏ö‡∏ô‡πâ‡∏≥ 7 ‡∏ß‡∏±‡∏ô" required class="mt-1"><span class="text-sm">‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏ô‡∏±ÿÆ‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÇ‡∏£‡∏Ñ‡∏û‡∏¥‡∏©‡∏™‡∏∏‡∏ô‡∏±‡∏Ç‡∏ö‡πâ‡∏≤</span></label>
                        <label class="flex items-start space-x-3 p-3 rounded-lg hover-green cursor-pointer"><input type="radio" name="appointmentType" value="‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏ô‡∏±‡∏Ç ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ : ‡∏á‡∏î‡∏≠‡∏≤‡∏ö‡∏ô‡πâ‡∏≥ 7 ‡∏ß‡∏±‡∏ô" required class="mt-1"><span class="text-sm">‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏ô‡∏±‡∏Ç</span></label>
                        <label class="flex items-start space-x-3 p-3 rounded-lg hover-green cursor-pointer"><input type="radio" name="appointmentType" value="‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏£‡∏ß‡∏°‡πÅ‡∏°‡∏ß ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ : ‡∏á‡∏î‡∏≠‡∏≤‡∏ö‡∏ô‡πâ‡∏≥ 7 ‡∏ß‡∏±‡∏ô" required class="mt-1"><span class="text-sm">‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏£‡∏ß‡∏°‡πÅ‡∏°‡∏ß</span></label>
                        <label class="flex items-start space-x-3 p-3 rounded-lg hover-green cursor-pointer"><input type="radio" name="appointmentType" value="‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏£‡∏ß‡∏°‡πÅ‡∏°‡∏ß‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÇ‡∏£‡∏Ñ‡∏û‡∏¥‡∏©‡∏™‡∏∏‡∏ô‡∏±‡∏Ç‡∏ö‡πâ‡∏≤ ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ : ‡∏á‡∏î‡∏≠‡∏≤‡∏ö‡∏ô‡πâ‡∏≥ 7 ‡∏ß‡∏±‡∏ô" required class="mt-1"><span class="text-sm">‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏£‡∏ß‡∏°‡πÅ‡∏°‡∏ß‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÇ‡∏£‡∏Ñ‡∏û‡∏¥‡∏©‡∏™‡∏∏‡∏ô‡∏±‡∏Ç‡∏ö‡πâ‡∏≤</span></label>
                        <label class="flex items-start space-x-3 p-3 rounded-lg hover-green cursor-pointer"><input type="radio" name="appointmentType" value="‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÇ‡∏£‡∏Ñ‡∏û‡∏¥‡∏©‡∏™‡∏∏‡∏ô‡∏±‡∏Ç‡∏ö‡πâ‡∏≤ ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ : ‡∏á‡∏î‡∏≠‡∏≤‡∏ö‡∏ô‡πâ‡∏≥ 7 ‡∏ß‡∏±‡∏ô" required class="mt-1"><span class="text-sm">‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÇ‡∏£‡∏Ñ‡∏û‡∏¥‡∏©‡∏™‡∏∏‡∏ô‡∏±‡∏Ç‡∏ö‡πâ‡∏≤</span></label>
                        <label class="flex items-start space-x-3 p-3 rounded-lg hover-green cursor-pointer"><input type="radio" name="appointmentType" value="‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏•‡∏¥‡∏ß‡∏Ñ‡∏µ‡πÄ‡∏°‡∏µ‡∏¢ ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ : ‡∏á‡∏î‡∏≠‡∏≤‡∏ö‡∏ô‡πâ‡∏≥ 7 ‡∏ß‡∏±‡∏ô" required class="mt-1"><span class="text-sm">‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏•‡∏¥‡∏ß‡∏Ñ‡∏µ‡πÄ‡∏°‡∏µ‡∏¢</span></label>
                        <label class="flex items-start space-x-3 p-3 rounded-lg hover-green cursor-pointer"><input type="radio" name="appointmentType" value="‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏´‡∏≤‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÑ‡∏ß‡∏£‡∏±‡∏™‡∏Å‡πà‡∏≠‡∏ô‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏•‡∏¥‡∏ß‡∏Ñ‡∏µ‡πÄ‡∏°‡∏µ‡∏¢ ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ : ‡∏á‡∏î‡∏≠‡∏≤‡∏ö‡∏ô‡πâ‡∏≥ 7 ‡∏ß‡∏±‡∏ô" required class="mt-1"><span class="text-sm">‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏´‡∏≤‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÑ‡∏ß‡∏£‡∏±‡∏™‡∏Å‡πà‡∏≠‡∏ô‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏•‡∏¥‡∏ß‡∏Ñ‡∏µ‡πÄ‡∏°‡∏µ‡∏¢</span></label>
                        <label class="flex items-start space-x-3 p-3 rounded-lg hover-green cursor-pointer"><input type="radio" name="appointmentType" value="‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ : ‡∏á‡∏î‡∏≠‡∏≤‡∏ö‡∏ô‡πâ‡∏≥ 7 ‡∏ß‡∏±‡∏ô" required class="mt-1"><span class="text-sm">‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô</span></label>
                        <label class="flex items-start space-x-3 p-3 rounded-lg hover-green cursor-pointer"><input type="radio" name="appointmentType" value="‡∏î‡∏π‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á" required class="mt-1"><span class="text-sm">‡∏î‡∏π‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á</span></label>
                        <label class="flex items-start space-x-3 p-3 rounded-lg hover-green cursor-pointer"><input type="radio" name="appointmentType" value="‡∏£‡∏±‡∏ö‡∏¢‡∏≤‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á" required class="mt-1"><span class="text-sm">‡∏£‡∏±‡∏ö‡∏¢‡∏≤‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á</span></label>
                        <label class="flex items-start space-x-3 p-3 rounded-lg hover-green cursor-pointer"><input type="radio" name="appointmentType" value="‡∏â‡∏µ‡∏î‡∏¢‡∏≤" required class="mt-1"><span class="text-sm">‡∏â‡∏µ‡∏î‡∏¢‡∏≤</span></label>
                        <label class="flex items-start space-x-3 p-3 rounded-lg hover-green cursor-pointer"><input type="radio" name="appointmentType" value="‡∏â‡∏µ‡∏î‡∏¢‡∏≤‡∏Ñ‡∏∏‡∏°" required class="mt-1"><span class="text-sm">‡∏â‡∏µ‡∏î‡∏¢‡∏≤‡∏Ñ‡∏∏‡∏°</span></label>
                        <label class="flex items-start space-x-3 p-3 rounded-lg hover-green cursor-pointer"><input type="radio" name="appointmentType" value="‡∏ï‡∏±‡∏î‡πÑ‡∏´‡∏°" required class="mt-1"><span class="text-sm">‡∏ï‡∏±‡∏î‡πÑ‡∏´‡∏°</span></label>
                        <label class="flex items-start space-x-3 p-3 rounded-lg hover-green cursor-pointer"><input type="radio" name="appointmentType" value="‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏•‡∏∑‡∏≠‡∏î" required class="mt-1"><span class="text-sm">‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏•‡∏∑‡∏≠‡∏î</span></label>
                        <label class="flex items-start space-x-3 p-3 rounded-lg hover-green cursor-pointer"><input type="radio" name="appointmentType" value="‡∏Ñ‡∏£‡∏ö‡∏£‡∏≠‡∏ö‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤ NEXGARD / NEXGARD SPECTRA ‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á" required class="mt-1"><span class="text-sm">‡∏Ñ‡∏£‡∏ö‡∏£‡∏≠‡∏ö‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤ NEXGARD / NEXGARD SPECTRA ‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á</span></label>
                        <label class="flex items-start space-x-3 p-3 rounded-lg hover-green cursor-pointer"><input type="radio" name="appointmentType" value="‡∏Ñ‡∏£‡∏ö‡∏£‡∏≠‡∏ö‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤ BRAVECTO ‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á" required class="mt-1"><span class="text-sm">‡∏Ñ‡∏£‡∏ö‡∏£‡∏≠‡∏ö‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤ BRAVECTO ‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á</span></label>
                        <label class="flex items-start space-x-3 p-3 rounded-lg hover-green cursor-pointer"><input type="radio" name="appointmentType" value="‡∏Ñ‡∏£‡∏ö‡∏£‡∏≠‡∏ö‡∏´‡∏¢‡∏≠‡∏î‡∏¢‡∏≤ ADVOCATE / NEXGARD COMBO ‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ : ‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏´‡∏•‡∏±‡∏á‡∏´‡∏¢‡∏≠‡∏î‡∏¢‡∏≤‡∏á‡∏î‡∏≠‡∏≤‡∏ö‡∏ô‡πâ‡∏≥ 2 ‡∏ß‡∏±‡∏ô" required class="mt-1"><span class="text-sm">‡∏Ñ‡∏£‡∏ö‡∏£‡∏≠‡∏ö‡∏´‡∏¢‡∏≠‡∏î‡∏¢‡∏≤ ADVOCATE / NEXGARD COMBO ‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á</span></label>
                        <label class="flex items-start space-x-3 p-3 rounded-lg hover-green cursor-pointer"><input type="radio" name="appointmentType" value="‡∏Ñ‡∏£‡∏ö‡∏£‡∏≠‡∏ö‡∏´‡∏¢‡∏≠‡∏î‡∏¢‡∏≤‡πÄ‡∏´‡πá‡∏ö‡∏´‡∏°‡∏±‡∏î ‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ : ‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏´‡∏•‡∏±‡∏á‡∏´‡∏¢‡∏≠‡∏î‡∏¢‡∏≤‡∏á‡∏î‡∏≠‡∏≤‡∏ö‡∏ô‡πâ‡∏≥ 2 ‡∏ß‡∏±‡∏ô" required class="mt-1"><span class="text-sm">‡∏Ñ‡∏£‡∏ö‡∏£‡∏≠‡∏ö‡∏´‡∏¢‡∏≠‡∏î‡∏¢‡∏≤‡πÄ‡∏´‡πá‡∏ö‡∏´‡∏°‡∏±‡∏î ‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á</span></label>
                        <label class="flex items-start space-x-3 p-3 rounded-lg hover-green cursor-pointer"><input type="radio" name="appointmentType" value="‡∏ó‡∏≥‡∏´‡∏°‡∏±‡∏ô" required class="mt-1"><span class="text-sm">‡∏ó‡∏≥‡∏´‡∏°‡∏±‡∏ô</span></label>
                        <label class="flex items-start space-x-3 p-3 rounded-lg hover-green cursor-pointer"><input type="radio" name="appointmentType" value="‡∏ó‡∏≥‡πÅ‡∏ú‡∏•" required class="mt-1"><span class="text-sm">‡∏ó‡∏≥‡πÅ‡∏ú‡∏•</span></label>
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="pt-6">
                    <button type="submit"
                            class="w-full bg-green-500 hover:bg-green-600 text-white font-semibold py-4 px-6 rounded-lg transition duration-300 transform hover:scale-105 shadow-lg">
                        üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                    </button>
                </div>
            </form>
        </div>

        <!-- Dashboard Section -->
        <div class="bg-white rounded-xl shadow-lg p-6 mt-8 border-2 border-green-pastel">
            <h2 class="text-2xl font-semibold text-green-dark mb-6 flex items-center">
                üìä ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
            </h2>
            <div id="dashboard" class="space-y-4">
                <div class="text-center py-8">
                    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-green-500 mx-auto mb-4"></div>
                    <p class="text-gray-600">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-green-600 text-white py-6 mt-12">
        <div class="container mx-auto px-6 text-center">
            <p class="text-lg font-medium">üè• ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏™‡∏∏‡∏£‡∏≤‡∏©‡∏è‡∏£‡πå‡∏ò‡∏≤‡∏ô‡∏µ 2568</p>
        </div>
    </footer>

    <script>
        // --- CONFIGURATION ---
        // URL ‡∏Ç‡∏≠‡∏á Google Apps Script ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwwtzEUk2yuCCoxrd53YRXfgN9cP6rtr3ixeLr9iD7aRNjuvx9TMk76Rq50hPpvYuyV/exec"; 
        
        // URL ‡∏Ç‡∏≠‡∏á Google Sheet ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• (gviz)
        const GVIZ_URL = "https://docs.google.com/spreadsheets/d/1UltCx_5u19F675ELpi7OUAxQJFh6UkbD6Qq__jQoL5Q/gviz/tq?tqx=out:json&sheet=DATA";

        // Convert Gregorian date to Buddhist Era
        function convertToBuddhistEra(gregorianDate) {
            const date = new Date(gregorianDate);
            const buddhistYear = date.getFullYear() + 543;
            const day = date.getDate().toString().padStart(2, '0');
            const month = (date.getMonth() + 1).toString().padStart(2, '0');
            return `${day}/${month}/${buddhistYear}`;
        }

        // Load dashboard data from Google Sheet
        async function loadDashboard() {
            const dashboard = document.getElementById('dashboard');
            if (!GVIZ_URL || GVIZ_URL.includes("YOUR_GOOGLE_SHEET_GVIZ_URL")) {
                dashboard.innerHTML = '<p class="text-center text-orange-500 py-8">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ GVIZ_URL ‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏Å‡πà‡∏≠‡∏ô</p>';
                return;
            }
            try {
                const response = await fetch(GVIZ_URL);
                const text = await response.text();
                // This parsing logic is specific to the Google Visualization API JSONP response format
                const jsonData = JSON.parse(text.substr(47).slice(0, -2));
                
                const rows = jsonData.table.rows;
                
                if (rows.length === 0) {
                    dashboard.innerHTML = '<p class="text-center text-gray-500 py-8">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>';
                    return;
                }
                
                // Get last 5 records and reverse them to show newest first
                const recentRows = rows.slice(-5).reverse();
                
                let html = '<div class="space-y-3">';
                recentRows.forEach((row, index) => {
                    const date = row.c[0]?.v || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏';
                    const phone = row.c[1]?.v || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏';
                    const petName = row.c[2]?.v || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏';
                    const appointmentType = row.c[3]?.v || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏';
                    
                    html += `
                        <div class="bg-green-50 border-l-4 border-green-400 p-4 rounded-r-lg">
                            <div class="flex justify-between items-start">
                                <div class="flex-1">
                                    <p class="font-semibold text-green-dark">üêæ ${petName}</p>
                                    <p class="text-sm text-gray-600">üìû ${phone}</p>
                                    <p class="text-sm text-gray-600">üìÖ ${date}</p>
                                    <p class="text-sm text-gray-700 mt-1">${appointmentType.split(' ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥')[0]}</p>
                                </div>
                                <span class="bg-green-200 text-green-800 text-xs px-2 py-1 rounded-full">‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</span>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
                dashboard.innerHTML = html;
            } catch (error) {
                console.error('Error loading dashboard:', error);
                dashboard.innerHTML = '<p class="text-center text-red-500 py-8">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>';
            }
        }

        // Handle form submission
        document.getElementById('smsForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (!SCRIPT_URL || SCRIPT_URL.includes("YOUR_GOOGLE_APPS_SCRIPT_URL")) {
                 Swal.fire({
                    icon: 'error',
                    title: '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤!',
                    text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ SCRIPT_URL ‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å',
                    confirmButtonColor: '#ef4444'
                });
                return;
            }

            const formData = new FormData(this);
            const data = {
                sendDate: convertToBuddhistEra(formData.get('sendDate')),
                phoneNumber: formData.get('phoneNumber'),
                petName: formData.get('petName'),
                appointmentType: formData.get('appointmentType')
            };

            Swal.fire({
                title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...',
                html: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà',
                allowOutsideClick: false,
                didOpen: () => { Swal.showLoading(); }
            });

            const callbackName = 'jsonp_callback_' + Math.round(100000 * Math.random());
            window[callbackName] = function(response) {
                document.head.removeChild(script);
                delete window[callbackName];
                
                if (response.result === 'success') {
                    Swal.fire({
                        icon: 'success',
                        title: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
                        text: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß',
                        confirmButtonColor: '#10b981'
                    }).then(() => {
                        document.getElementById('smsForm').reset();
                        document.getElementById('sendDate').valueAsDate = new Date();
                        loadDashboard(); // Refresh dashboard
                    });
                } else {
                    handleError(new Error(response.error || 'Unknown error from Apps Script'));
                }
            };

            const params = new URLSearchParams({
                callback: callbackName,
                ...data
            });

            const script = document.createElement('script');
            script.src = `${SCRIPT_URL}?${params.toString()}`;
            script.onerror = () => handleError(new Error('Script loading failed. Check SCRIPT_URL and CORS settings.'));
            document.head.appendChild(script);
            
            // Timeout to prevent infinite loading
            setTimeout(() => {
                if (window[callbackName]) {
                    document.head.removeChild(script);
                    delete window[callbackName];
                    handleError(new Error('Request timed out. Check your Apps Script deployment.'));
                }
            }, 10000); // 10 seconds
        });

        function handleError(error) {
            console.error('Error:', error);
            Swal.fire({
                icon: 'error',
                title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î!',
                text: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡∏∞‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á',
                confirmButtonColor: '#ef4444'
            });
        }

        // Phone number validation
        document.getElementById('phoneNumber').addEventListener('input', function(e) {
            e.target.value = e.target.value.replace(/[^0-9]/g, '');
        });

        // --- INITIAL LOAD ---
        // Set default date to today
        document.getElementById('sendDate').valueAsDate = new Date();
        // Load dashboard on page load
        loadDashboard();
    </script>
</body>
</html>
